#!/usr/bin/env node

const path = require('path');
const parseArgs = require('minimist');

require('babel-register')({
  only: ['server.js','routes.js', `${process.cwd()}/pages/*`, `pages/*`],
  presets: ['stage-0', 'es2015', 'react'],
  plugins: ['transform-class-properties'],
});
const server = require('../server');

const argv = parseArgs(process.argv.slice(2), {
  alias: {
    h: 'help',
    p: 'port'
  },
  boolean: ['h'],
  default: {
    p: 3000
  }
})

const dir = path.resolve(argv._[0] || '.')

server({ dir })
  .start(argv.port)
  .then(() => console.log('> Ready on http://localhost:%d', argv.port))
  .catch((err) => {
    console.error(err)
    process.exit(1)
  })
